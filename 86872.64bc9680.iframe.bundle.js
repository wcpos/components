(self.webpackChunk_wcpos_components=self.webpackChunk_wcpos_components||[]).push([[86872,10083],{"./src/numpad/reducer.test.ts":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var _reducer=__webpack_require__("./src/numpad/reducer.ts");describe("reducer",(function(){it("adds digit",(function(){var action={type:_reducer.ACTIONS.ADD_DIGIT,payload:{digit:"2"}},newState=(0,_reducer.reducer)({currentOperand:"1"},action);expect(newState).toEqual({currentOperand:"12"})})),it("chooses operation",(function(){var action={type:_reducer.ACTIONS.CHOOSE_OPERATION,payload:{operation:"+"}},newState=(0,_reducer.reducer)({currentOperand:"1",previousOperand:null,operation:null},action);expect(newState).toEqual({previousOperand:"1",operation:"+",currentOperand:null})})),it("clears state",(function(){var action={type:_reducer.ACTIONS.CLEAR},newState=(0,_reducer.reducer)({currentOperand:"1",previousOperand:"2"},action);expect(newState).toEqual({overwrite:!1,currentOperand:null,previousOperand:null,operation:null})})),it("deletes digit",(function(){var action={type:_reducer.ACTIONS.DELETE_DIGIT},newState=(0,_reducer.reducer)({currentOperand:"12"},action);expect(newState).toEqual({currentOperand:"1"})})),it("add numbers",(function(){var action={type:_reducer.ACTIONS.EVALUATE,payload:{decimalSeparator:"."}},newState=(0,_reducer.reducer)({currentOperand:"2",previousOperand:"1",operation:"+"},action);expect(newState).toEqual({overwrite:!0,currentOperand:"3",previousOperand:null,operation:null})})),it("subtracts numbers",(function(){var action={type:_reducer.ACTIONS.EVALUATE,payload:{decimalSeparator:"."}},newState=(0,_reducer.reducer)({currentOperand:"2",previousOperand:"1",operation:"-"},action);expect(newState).toEqual({overwrite:!0,currentOperand:"-1",previousOperand:null,operation:null})})),it("multiplies numbers (with rounding)",(function(){var action={type:_reducer.ACTIONS.EVALUATE,payload:{decimalSeparator:"."}},newState=(0,_reducer.reducer)({currentOperand:"3",previousOperand:"3.333333333",operation:"*"},action);expect(newState).toEqual({overwrite:!0,currentOperand:"10",previousOperand:null,operation:null})})),it("should switch the sign of the current operand",(function(){var state={currentOperand:"123"};state=(0,_reducer.reducer)(state,{type:_reducer.ACTIONS.SWITCH_SIGN,payload:{operation:"+/-"}}),expect(state).toEqual({currentOperand:"-123"}),state=(0,_reducer.reducer)(state,{type:_reducer.ACTIONS.SWITCH_SIGN,payload:{operation:"+/-"}}),expect(state).toEqual({currentOperand:"123"})})),describe("quick discount functionality",(function(){it("applies a 5% discount",(function(){var state={currentOperand:"100"};state=(0,_reducer.reducer)(state,{type:_reducer.ACTIONS.APPLY_DISCOUNT,payload:{discount:5}}),expect(state).toEqual({currentOperand:"95",overwrite:!0})})),it("applies another 5% discount",(function(){var state={currentOperand:"95"};state=(0,_reducer.reducer)(state,{type:_reducer.ACTIONS.APPLY_DISCOUNT,payload:{discount:5}}),expect(state).toEqual({currentOperand:90.25.toString(),overwrite:!0})})),it("applies a third 5% discount",(function(){var state={currentOperand:90.25.toString()};state=(0,_reducer.reducer)(state,{type:_reducer.ACTIONS.APPLY_DISCOUNT,payload:{discount:5}}),expect(state).toEqual({currentOperand:85.7375.toString(),overwrite:!0})})),it("applies a -10% discount resulting in 110%",(function(){var state={currentOperand:"100"};state=(0,_reducer.reducer)(state,{type:_reducer.ACTIONS.APPLY_DISCOUNT,payload:{discount:-10}}),expect(state).toEqual({currentOperand:"110",overwrite:!0})}))}))}))},"./src/numpad/reducer.ts":(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ACTIONS=void 0,exports.formatOperand=function formatOperand(operand){},exports.reducer=function reducer(state,action,config){var type=action.type,payload=action.payload,decimalSeparator=(null==config?void 0:config.decimalSeparator)||".",precision=(null==config?void 0:config.precision)||6;switch(type){case ACTIONS.ADD_DIGIT:return state.overwrite||payload.overwrite?Object.assign({},state,{currentOperand:payload.digit,overwrite:!1}):"0"===payload.digit&&"0"===state.currentOperand||payload.digit===decimalSeparator&&state.currentOperand&&state.currentOperand.includes(decimalSeparator)?state:payload.digit===decimalSeparator&&null==state.currentOperand?Object.assign({},state,{currentOperand:"0".concat(decimalSeparator)}):"0"===state.currentOperand?Object.assign({},state,{currentOperand:payload.digit}):Object.assign({},state,{currentOperand:"".concat(state.currentOperand||"").concat(payload.digit)});case ACTIONS.CHOOSE_OPERATION:return null==state.currentOperand&&null==state.previousOperand?state:null==state.currentOperand?Object.assign({},state,{operation:payload.operation}):null==state.previousOperand?Object.assign({},state,{operation:payload.operation,previousOperand:state.currentOperand,currentOperand:null}):Object.assign({},state,{previousOperand:evaluate(state,decimalSeparator,precision),operation:payload.operation,currentOperand:null});case ACTIONS.CLEAR:return{currentOperand:null,operation:null,overwrite:!1,previousOperand:null};case ACTIONS.DELETE_DIGIT:return state.overwrite?Object.assign({},state,{overwrite:!1,currentOperand:null}):null==state.currentOperand?state:1===state.currentOperand.length?Object.assign({},state,{currentOperand:null}):Object.assign({},state,{currentOperand:state.currentOperand.slice(0,-1)});case ACTIONS.EVALUATE:return null==state.operation||null==state.currentOperand||null==state.previousOperand?state:Object.assign({},state,{overwrite:!0,previousOperand:null,operation:null,currentOperand:evaluate(state,decimalSeparator,precision)});case ACTIONS.SWITCH_SIGN:return state.currentOperand&&"0"!==state.currentOperand?state.currentOperand.startsWith("-")?Object.assign({},state,{currentOperand:state.currentOperand.slice(1)}):Object.assign({},state,{currentOperand:"-".concat(state.currentOperand)}):state;case ACTIONS.APPLY_DISCOUNT:if(!state.currentOperand)return state;var discountMultiplier=(100-payload.discount)/100,discountedValue=round(parseFloat(state.currentOperand)*discountMultiplier,precision);return Object.assign({},state,{currentOperand:discountedValue,overwrite:!0});default:return state}};var ACTIONS=exports.ACTIONS={ADD_DIGIT:"add-digit",CHOOSE_OPERATION:"choose-operation",CLEAR:"clear",DELETE_DIGIT:"delete-digit",EVALUATE:"evaluate",SWITCH_SIGN:"switch-sign",APPLY_DISCOUNT:"apply-discount"};function round(value,precision){var multiplier=Math.pow(10,precision);return(Math.round(value*multiplier)/multiplier).toString()}function evaluate(state,decimalSeparator,precision){var _state$previousOperan,_state$currentOperand,prev=parseFloat((null==(_state$previousOperan=state.previousOperand)?void 0:_state$previousOperan.replace(decimalSeparator,"."))||""),current=parseFloat((null==(_state$currentOperand=state.currentOperand)?void 0:_state$currentOperand.replace(decimalSeparator,"."))||"");if(Number.isNaN(prev)||Number.isNaN(current))return"";var computation=0;switch(state.operation){case"+":computation=prev+current;break;case"-":computation=prev-current;break;case"*":computation=prev*current;break;case"รท":computation=prev/current}return round(computation,precision).replace(".",decimalSeparator)}}}]);